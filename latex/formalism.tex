\title{CESK* / CFA Formalism}
\author{
	Davis Silverman
}
\date{}

\documentclass[12pt,draft]{article}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{tikz}
\usepackage{titling}
\usepackage{multicol}

\setlength{\columnsep}{0cm} % Column separation from multicol
% \setlength{\droptitle}{-10em}  % Make title not in middle of page (uses titling package)
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}

% \setcounter{section}{-1} % sets the first section number to 0
\newcommand\mdoubleplus{\ensuremath{\mathbin{+\mkern-9mu+}}}
\newcommand\mae{\ensuremath{\text{\ae}}}
\newcommand{\lamsyn}[2]{(\lambda\;(#1 ...)\;#2)}
\newcommand{\singlelamsyn}[2]{(\lambda\;(#1)\;#2)}
\newcommand{\vararglamsyn}[2]{(\lambda\;#1\;#2)}
\newcommand{\letsyn}[3]{(\texttt{let}\;([#1\;#2]\;...)\;#3)}
\newcommand{\ifsyn}[3]{(\texttt{if}\;#1\;#2\;#3)}
\newcommand{\primsyn}[2]{(\texttt{prim}\;#1\;#2\;...)}
\newcommand{\singleprimsyn}[1]{(\texttt{prim}\;#1)}
\newcommand{\applyprimsyn}[2]{(\texttt{apply-prim}\;#1\;#2)}
\newcommand{\applysyn}[2]{(\texttt{apply}\;#1\;#2)}
\newcommand{\callccsyn}[1]{(\texttt{call/cc}\;#1)}
\newcommand{\setsyn}[2]{(\texttt{set!}\;#1\;#2)}
\newcommand{\quotesyn}[1]{(\texttt{quote}\;#1)}

\newcommand{\truesyn}{\texttt{\#t}}
\newcommand{\falsesyn}{\texttt{\#f}}
\begin{document}
% \maketitle


% textsf for syntactic domains
% textit for semantic domains
% \maketitle
\section{Concrete Semantics of Scheme CESKt*}

\small{
\begin{multicols*}{2}
\begin{center}
\textbf{Syntax Domains:}
\end{center}
\vspace{-18mm}
\begin{center}
\begin{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% EXPRESSIONS %%%%%%%%%%%%%%%%%%%%%%%%%
e \in \textsf{Exp} &::= \mae \\
				&|\; \ifsyn{e}{e}{e} \\
				&|\; \letsyn{x}{e}{e} \\
				&|\; \callccsyn{e} \\
				&|\; \setsyn{x}{e} \\
				&|\; \primsyn{op}{e} \\
				&|\; \applyprimsyn{op}{e} \\
				&|\; \applysyn{e}{e} \\
				&|\; (e\;e\;...) \\
%%%%%%%%%%%%%%%%%%%%%%%%% ATOMIC EXPRESSIONS %%%%%%%%%%%%%%%%%%%%%%%%%
\mae \in \textsf{AExp} &::= x\;|\; lam\;|\; \mathbb{Z}
							\;|\; \truesyn \;|\; \falsesyn \\
				&\;\;\;\;\;\;\;\;\;\, |\; \quotesyn{e} \\
%%%%%%%%%%%%%%%%%%%%%%%%% LAMBDA EXPRESSIONS %%%%%%%%%%%%%%%%%%%%%%%%%
lam \in \textsf{Lam} &::= \lamsyn{x}{e} \;|\; \vararglamsyn{x}{e} \\
%%%%%%%%%%%%%%%%%%%%%%%%% VARIABLE SET %%%%%%%%%%%%%%%%%%%%%%%%%
x \in \textsf{Var}   &\;\;\;\;\;\; \text{A set of identifiers} \\
%%%%%%%%%%%%%%%%%%%%%%%%% PRIMITIVE SET %%%%%%%%%%%%%%%%%%%%%%%%%
op \in \textsf{Prim} &\;\;\;\;\;\; \text{A set of primitives}
%%%%%%%%%%%%%%%%%%%%%%%%% END SYNTAX DOMAINS %%%%%%%%%%%%%%%%%%%%%%%%%
\end{align*}
\end{center}
%%%%%%%%%%%%%%%%%%%%% OTHER THINGS COLUMN 1! %%%%%%%%%%%%%%%%%%
\vspace{-7mm}
%%%%%%%%%%%%%%%%%%%%%%%%% ATOMIC EVALUATION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\textbf{Atomic Evaluation:}
\vspace{-3mm}
\begin{align*}
\mathcal{A} : \Sigma_E \times \sigma &\rightharpoonup \textit{Val} \\
\mathcal{A}( \langle lam , \rho , \_ , \_ \rangle, \_)  &\triangleq (lam , \rho) \\
\mathcal{A}( \langle \quotesyn{e} , \_ , \_ , \_ \rangle, \_)  &\triangleq \textbf{quote}(e) \\
\mathcal{A}( \langle x , \rho , \_ , \_ \rangle, \sigma) &\triangleq \sigma(\rho(x)) \\
\mathcal{A}( \langle \mae , \_ , \_ , \_ \rangle, \_) &\triangleq \mae
\end{align*}
\end{center}
\vspace{-7mm}
%%%%%%%%%%%%%%%%%%%%%%%%% TICK/ALLOC FUNCTIONS %%%%%%%%%%%%%%%%
\begin{center}
\textbf{Tick/Alloc:}
\vspace{-3mm}
\begin{align*}
tick : \textit{Eval} \times \mathbb{N} &\rightarrow \textit{Time} \\
tick(E\langle \_, \_ , \_, t \rangle, n) &\triangleq (t + n) \\
alloc : \Sigma \times \mathbb{N} &\triangleq \textit{Addr} \\
alloc(E\langle \_, \_ , \_, t \rangle, n) &\triangleq (t + n) \\
\end{align*}
\end{center}
\vspace{-14mm}
%%%%%%%%%%%%%%%%%%%%%%%%% INJECTION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\textbf{Injection:} \\
$\mathcal{I} : \textsf{Exp} \rightarrow \Sigma$ \\
$\mathcal{I}(e) \triangleq (e , \varnothing , \varnothing , \{0 : \textbf{mt}\} , 0 , 1)$
\end{center}
\vspace{-8mm}
%%%%%%%%%%%%%%%%%%%%%%%%% TRANSITION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\textbf{Transition:}
\end{center}
\vspace{-10mm}
%%%%%%%%%%%%%%%%%%%%%%%%% COLLECTING SEMANTICS %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\textbf{Collecting Semantics:}
\end{center}
\vspace{-10mm}


%%%%% COLUMN BREAK %%%%%%
\vfill\null
\columnbreak
%%%%% COLUMN BREAK %%%%%%


\begin{center}
\textbf{Semantic Domains:}
\end{center}
\vspace{-18mm}
\begin{center}
\begin{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% STATES %%%%%%%%%%%%%%%%%%%%%%%%%
\varsigma \in \Sigma &\triangleq E\langle\textit{Eval}\rangle
								+ A\langle\textit{Apply}\rangle \\
  \textit{Eval} &\triangleq
                  \textsf{Exp} \times \textit{Env} \times \textit{Store} \\
                     & \times \textit{KStore} \times \textit{Addr} \times \textit{Time} \\
  \textit{Apply} &\triangleq
                   \textit{Val} \times \textit{Store} \\
                     & \times \textit{KStore} \times \textit{Addr} \times \textit{Time} \\
%%%%%%%%%%%%%%%%%%%%%%%%% ENVIRONMENT %%%%%%%%%%%%%%%%%%%%%%%%%
  \rho \in \textit{Env} &\triangleq \textsf{Var} \rightharpoonup
	  											\textit{Addr} \\
%%%%%%%%%%%%%%%%%%%%%%%%% STORE %%%%%%%%%%%%%%%%%%%%%%%%%
  \sigma \in \textit{Store} &\triangleq \textit{Addr} \rightharpoonup
                              \textit{Val} \\
%%%%%%%%%%%%%%%%%%%%%%%%% STORE %%%%%%%%%%%%%%%%%%%%%%%%%
  \sigma \in \textit{Store} &\triangleq \textit{Addr} \rightharpoonup
                              \textit{Kont} \\
%%%%%%%%%%%%%%%%%%%%%%%%% VALUES %%%%%%%%%%%%%%%%%%%%%%%%%
v \in \textit{Val} &\triangleq \textit{Clo} + \textit{Kont} + \mathbb{Z} \\
				&+ \{ \truesyn,\falsesyn, \textit{Null} , \textit{Void} \} \\
				&+ \{\textbf{quote}(e) , \textbf{cons}(v, v)\} \\
%%%%%%%%%%%%%%%%%%%%%%%%% CLOSURES %%%%%%%%%%%%%%%%%%%%%%%%%
clo \in \textit{Clo} &\triangleq \textsf{Lam} \times \textit{Env} \\
%%%%%%%%%%%%%%%%%%%%%%%%% ADDRESSES %%%%%%%%%%%%%%%%%%%%%%%%%
a, a_\kappa \in \textit{Addr} &\triangleq \mathbb{N} \\
%%%%%%%%%%%%%%%%%%%%%%%%% TIME %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
t \in \textit{Time} &\triangleq \mathbb{N} \\
%%%%%%%%%%%%%%%%%%%%%%%%% KONTINUATIONS %%%%%%%%%%%%%%%%%%%%%%%%%
\kappa \in \textit{Kont} &::= \textbf{mt} \\
        &|\; \textbf{ifk}(e, e, \rho, a) \\
        &|\; \textbf{callcck}(a) \\
        &|\; \textbf{setk}(x, \rho, a) \\
        &|\; \textbf{appappk}(val?, e, \rho, a) \\
        &|\; \textbf{appk}(done, todo, \rho, a) \\
        &|\; \textbf{appprimk}(op, a) \\
        &|\; \textbf{primk}(op, done, todo, \\
        &\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\rho, a) \\
        &|\; \textbf{letk}(vars, done, todo, \\
        &\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;e, \rho, a) \\
%%%%%%%%%%%%%%%%%%%%%%%%% OTHER VARIABLES %%%%%%%%%%%%%%%%%%%%%%%%%
%%% done/todo variables
done &\triangleq \textit{Val}^\ast \\
todo &\triangleq \textsf{Exp}^* \\
vars &\triangleq \textsf{Var}^*
\end{align*}
\end{center}
\end{multicols*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%% BEGIN EVAL SEMANTICS %%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\footnotesize{
\begin{multicols*}{2}
[
\begin{center}
\textbf{Eval Rules} \\
Rules for when the control is an expression \\
%%%%%%%%%%%%%%%%%%%%%%%%% ATOMIC EVALUATION %%%%%%%%%%%%%%%%
\vspace{3mm}
$E\langle \mae , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle
\leadsto
A\langle v , \sigma , \sigma_\kappa , a_\kappa , t \rangle$ \\
where $v \triangleq \mathcal{A}(\varsigma)$
\end{center}
]
%%%%%%%%%%%%%%%%%%%%%%%%% IF EXPRESSION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \ifsyn{e_c}{e_t}{e_f} , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
  $\leadsto E\langle e_c , \rho , \sigma , \sigma'_\kappa , a'_\kappa , t' \rangle$
\end{center}
\vspace{-5mm}
\begin{align*}
  \text{where }
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa &\triangleq \textbf{ifk}(e_t, e_f, \rho, a_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% LET EXPRESSION NO ARGSVALS %%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle (\texttt{let}\;()\;e) , \rho , \sigma,\sigma_\kappa,a_\kappa , t \rangle$
  $\leadsto E\langle e , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
\end{center}
\vspace{-3mm}
%%%%%%%%%%%%%%%%%%%%%%%%% LET EXPRESSION VALS GOT ARGS %%%%%%%%%%%%%%%
\begin{center}
  $E\langle (\texttt{let}\;bs\;e_b), \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
   $\leadsto E\langle e_0 , \rho , \sigma , \sigma'_\kappa , a'_\kappa , t' \rangle$
\end{center}
\vspace{-5mm}
\begin{align*}
  \text{where }
  bs &= ([x_0\;e_0]\;[x_s\;e_s]\;...) \\
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa &\triangleq \textbf{letk}(x_0::x_s, [\;], e_s, e_b, \rho, a_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% CALL/CC EXPRESSION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \callccsyn{e} , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
  $\leadsto E\langle e , \rho , \sigma , \sigma'_\kappa , a'_\kappa , t' \rangle$
\end{center}
\vspace{-5mm}
\begin{align*}
  \text{where }
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa &\triangleq \textbf{callcck}(a_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% SET EXPRESSION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \setsyn{x}{e} , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
  $\leadsto E\langle e , \rho , \sigma , \sigma'_\kappa , a'_\kappa , t' \rangle$
\end{center}
\vspace{-5mm}
\begin{align*}
  \text{where }
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  a &\triangleq \rho(x) \\
  \kappa &\triangleq \textbf{setk}(a, a_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa]
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\vfill\null
\columnbreak
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%% PRIM NO ARG EXPRESSION %%%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \singleprimsyn{op} , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
  $\leadsto A\langle v , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } v &= op \text{ applied to } 0 \text{ arguments}
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% PRIM WITH ARGS EXPRESSION %%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \primsyn{op}{e_0\;e_s} , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
  $\leadsto E\langle e_0 , \rho , \sigma , \sigma'_\kappa , a'_\kappa , t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa &\triangleq \textbf{primk}(op, [\;], e_s, \rho, a_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY PRIM EXPRESSION %%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \applyprimsyn{op}{e} , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
  $\leadsto E\langle e , \rho , \sigma , \sigma'_\kappa , a'_\kappa , t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa &\triangleq \textbf{appprimk}(op, a_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY FUNCTION LIST EXPRESSION %%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \applysyn{e_f}{e_x} , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
  $\leadsto E\langle e_f , \rho , \sigma , \sigma_\kappa , a'_\kappa , t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa &\triangleq \textbf{appappk}(\varnothing, e_x, \rho, a_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION EXPRESSION %%%%%%%%%%%%%%%%
\begin{center}
  $E\langle (e_f\;e_s\;...) , \rho , \sigma , \sigma_\kappa , a_\kappa , t \rangle$
  $\leadsto E\langle e_f , \rho , \sigma , \sigma'_\kappa , a'_\kappa , t' \rangle$
\end{center}
\vspace{-5mm}
\begin{align*}
  \text{where }
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa &\triangleq \textbf{appk}([\;], e_s, \rho, a_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa]
\end{align*}
\end{multicols*}
} % footnotesize


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%% BEGIN APPLY SEMANTICS %%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% PAGE 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage


\begin{multicols*}{2}
[
\begin{center}
\textbf{Apply Rules} \\
Rules for when the control is a value \\
$\varsigma = A\langle v , \sigma , \sigma_\kappa , a_\kappa , t \rangle$ \\
$\kappa \triangleq \sigma_\kappa(a_\kappa)$ \\
Proceed by matching on $\kappa$ \\
%%%%%%%%%%%%%%%%%%%%%%%%% EMPTY KONT %%%%%%%%%%%%%%%%%%%%%%%%%
\vspace{5mm}
$\textbf{mt} \leadsto \varsigma$
\end{center}
\vspace{-5mm}
]
%%%%%%%%%%%%%%%%%%%%%%%%% IF KONT FALSE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{ifk}(e_t, e_f, \rho_\kappa , a'_\kappa)$
  $\leadsto E\langle e_f , \rho_\kappa , \sigma , \sigma_\kappa , a'_\kappa , t \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } v &= \falsesyn
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% IF KONT TRUE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{ifk}(e_t, e_f, \rho_\kappa , a'_\kappa)$
  $\leadsto E\langle e_t , \rho_\kappa , \sigma , \sigma_\kappa , a'_\kappa , t \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } v &\not= \falsesyn
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% LET KONT DONE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{letk}(vars, done, [\;], e_b, \rho_\kappa , a'_\kappa)$
  $\leadsto E\langle e_b , \rho'_\kappa , \sigma' , \sigma_\kappa , a'_\kappa , t' \rangle $
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } a_i &\triangleq alloc(\varsigma, i) \\
  t' &\triangleq tick(\varsigma, n) \\
  done' &\triangleq done \mdoubleplus [v] \\
  \rho'_{\kappa} &\triangleq \rho_{\kappa}[vars_0 \mapsto a_0\;...\\
                    &\;\;\;\;\;\;\;\;\;\;  vars_{n-1} \mapsto a_{n-1}] \\
  \sigma' &\triangleq \sigma[a_0 \mapsto done'_0\;...\\
                    &\;\;\;\;\;\;\;\;a_{n-1} \mapsto done'_{n-1}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% LET KONT MORE TODO %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{letk}(vars, done, e_h::e_t , e_b , \rho_\kappa, a'_\kappa)$
  $\leadsto E\langle e_h , \rho_\kappa , \sigma , \sigma'_\kappa , a''_\kappa , t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  a''_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa' &\triangleq \textbf{letk}(vars, done \mdoubleplus [v], \\
             &\;\;\;\;\;\;\;\;\;\;\;\;\;e_t, e_b, \rho_\kappa, a'_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a''_\kappa \mapsto \kappa']
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% SET! KONT %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{setk}(a, a'_\kappa)$
  $\leadsto A\langle \textit{Void} , \sigma' , \sigma_\kappa , a'_\kappa , t \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \sigma' &\triangleq \sigma[a \mapsto v]
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\vfill\null
\columnbreak
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%% CALL/CC MULTIARG KONT %%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{callcck}(a'_\kappa)$
  $\leadsto E\langle e , \rho'_\lambda , \sigma' , \sigma_\kappa , a'_\kappa , t \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } v &= (\singlelamsyn{x}{e} , \rho_{\lambda}) \\
  a &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa' &\triangleq \sigma_\kappa(a'_\kappa) \\
  \rho'_{\lambda} &\triangleq \rho_{\lambda}[x \mapsto a] \\
  \sigma' &\triangleq \sigma[a \mapsto \kappa']
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% CALL/CC KONT ARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{callcck}(\_)$
  $\leadsto A\langle \kappa , \sigma , \sigma'_\kappa , a'_\kappa  , t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  v &= \kappa' \\
  a'_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a'_\kappa \mapsto \kappa']
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY PRIM KONT %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appprimk}(op, a'_\kappa)$
  $\leadsto A\langle v' , \sigma , \sigma_\kappa , a'_\kappa ,t) \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } v' &\triangleq op \text{ applied to } v
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% PRIM KONT DONE %%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{primk}(op, done, [\;], \rho_\kappa, a'_\kappa)$
  $\leadsto A\langle v' , \sigma , \sigma_\kappa , a'_\kappa , t \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } v' &\triangleq op \text{ applied to } (done \mdoubleplus [v])
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% PRIM KONT NOT DONE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{primk}(op, done, e_h::e_t, \rho_\kappa, a'_\kappa)$
  $\leadsto E\langle e_h , \rho_\kappa ,\sigma ,\sigma'_\kappa,a''_\kappa, t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  a''_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa' &\triangleq \textbf{primk}(op, done \mdoubleplus [v],\\
             &\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;e_t, \rho_\kappa, a'_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a''_\kappa \mapsto \kappa']
\end{align*}
\end{multicols*}
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%% MORE APPLY SEMANTICS %%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% PAGE 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{multicols*}{2}
[
\begin{center}
\textbf{More Apply Rules} \\
Rules for when the control is a value
\end{center}
]
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY LIST DONE MULTIARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appappk}(v_f, \_, \_, a'_\kappa)$
  $\leadsto E\langle e_b , \rho'_\lambda , \sigma',\sigma_\kappa,a'_\kappa,t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  v_f &= (\lamsyn{x_s}{e_b}, \rho_{\lambda}) \\
  a_i &\triangleq alloc(\varsigma, i) \\
  t' &\triangleq tick(\varsigma, n) \\
  \rho'_{\lambda} &\triangleq \rho_{\lambda}[x_0 \mapsto a_0\; ... \\
      &\;\;\;\;\;\;\;\;\;x_{n-1} \mapsto a_{n-1}] \\
  \sigma' &\triangleq \sigma[a_0 \mapsto v_0\;...\\
      &\;\;\;\;\;\;\;\;a_{n-1} \mapsto v_{n-1}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY LIST DONE VARARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appappk}(v_f, \_, \_, a'_\kappa)$
  $\leadsto E\langle e_b , \rho'_\lambda,\sigma',\sigma_\kappa,a'_\kappa , t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  v_f &= (\vararglamsyn{x}{e_b}, \rho_{\lambda}) \\
  a &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \rho'_{\lambda} &\triangleq \rho_{\lambda}[x \mapsto a] \\
  \sigma' &\triangleq \sigma[a \mapsto v]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY LIST KONT NOT DONE %%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appappk}(\varnothing, e, \rho_\kappa, a'_\kappa)$
  $\leadsto E\langle e,\rho_\kappa,\sigma , \sigma'_\kappa , a''_\kappa , t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  a''_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa' &\triangleq \textbf{appappk}(v, e, \rho_\kappa, a'_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a''_\kappa \mapsto \kappa']
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\vfill\null
\columnbreak
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION MULTIARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appk}(done, [\;], \_, a'_\kappa)$
  $\leadsto E\langle e_b , \rho'_\lambda , \sigma',\sigma_\kappa,a'_\kappa,t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  done &= (\lamsyn{x_s}{e_b}, \rho_{\lambda}) :: v_s \\
  a_i &\triangleq alloc(\varsigma, i) \\
  t' &\triangleq tick(\varsigma, n) \\
  v'_s &\triangleq v_s \mdoubleplus [v] \\
  \rho'_{\lambda} &\triangleq \rho_{\lambda}[x_0 \mapsto a_0 \;... \\
       &\;\;\;\;\;\;\;\;\;x_{n-1} \mapsto a_{n-1}] \\
  \sigma' &\triangleq \sigma[a_0 \mapsto v'_0\;...\\
       &\;\;\;\;\;\;\;\;a_{n-1} \mapsto v'_{n-1}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION VARARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appk}(done, [\;], \_, a'_\kappa)$
  $\leadsto E\langle e_b, \rho'_\lambda , \sigma',\sigma_\kappa,a'_\kappa,t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  done &= (\vararglamsyn{x}{e_b}, \rho_{\lambda}) :: v_s \\
  a &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  v'_s &\triangleq (v_s \mdoubleplus [v]) \\
  \rho'_{\lambda} &\triangleq \rho_{\lambda}[x \mapsto a] \\
  \sigma' &\triangleq \sigma[a \mapsto v'_s]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION KONTINUATION %%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appk}([\kappa_\lambda] , [\;] , \rho_\kappa , a'_\kappa)$
  $\leadsto A\langle v , \sigma , \sigma'_\kappa,a''_\kappa,t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  a''_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a''_\kappa \mapsto \kappa_\lambda]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION TODO %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appk}(done, e_h::e_t, \rho_\kappa, a'_\kappa)$
  $\leadsto E\langle e_h , \rho_\kappa , \sigma ,\sigma'_\kappa,a''_\kappa,t' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  a''_\kappa &\triangleq alloc(\varsigma, 0) \\
  t' &\triangleq tick(\varsigma, 1) \\
  \kappa' &\triangleq \textbf{appk}(done \mdoubleplus [v] , e_t , \rho_\kappa , a'_\kappa) \\
  \sigma'_\kappa &\triangleq \sigma_\kappa[a''_\kappa \mapsto \kappa']
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% ITS OVER %%%%%%%%%%%%%%%%%%%%%%%%%
\end{multicols*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT SEMANTICS %%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\section{Abstract Semantics of Scheme CESKt*}

\begin{multicols*}{2}
  [
  \begin{center}
    \textbf{Abstract Semantic Domains:}
  \end{center}
  \vspace{-15mm}]
  \begin{align*}
    \vspace{-10mm}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT STATE %%%%%%%%%%%%%%%%%%%%%%%
    \hat{\varsigma} \in \hat{\Sigma}
    &\triangleq E\langle \textit{Eval} \rangle + E\langle \textit{Apply} \rangle\\
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT EVAL STATE %%%%%%%%%%%%%%%%%%
    Eval &\triangleq \textsf{Exp} \times \widehat{\textit{Env}} \times
           \widehat{\textit{Store}} \\
    &\times \widehat{\textit{KStore}} \times \widehat{\textit{Addr}}
      \times \widehat{\textit{Time}} \\
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT APPLY STATE %%%%%%%%%%%%%%%%%
    Apply &\triangleq \widehat{\textit{Val}} \times \widehat{\textit{Store}} \\
    &\times \widehat{\textit{KStore}} \times \widehat{\textit{Addr}}
      \times \widehat{\textit{Time}} \\
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT ENV %%%%%%%%%%%%%%%%%%%%%%%%%
    \hat{\rho} \in \widehat{\textit{Env}}
    &\triangleq \textsf{Var} \rightharpoonup \widehat{\textit{Addr}} \\
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT STORE %%%%%%%%%%%%%%%%%%%%%%%%%
    \hat{\sigma} \in \widehat{\textit{Store}}
    &\triangleq \widehat{\textit{Addr}} \rightharpoonup \mathcal{P}(\textit{Val}) \\
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT KSTORE %%%%%%%%%%%%%%%%%%%%%%%%%
    \hat{\sigma}_\kappa \in \widehat{\textit{KStore}}
    &\triangleq \widehat{\textit{Addr}}
      \rightharpoonup \mathcal{P}(\widehat{\textit{Kont}}) \\
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT VALUE %%%%%%%%%%%%%%%%%%%%%%%%%
    \hat{v} \in \widehat{\textit{Val}}
    &\triangleq \widehat{\textit{Clo}} + \widehat{\textit{Kont}} + \mathbb{Z} \\
    &+ \{\truesyn , \falsesyn , \textit{Null} , \textit{Void}\} \\
    &+ \{\textbf{quote}(e) , \textbf{cons}(v, v)\} \\
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT CLO %%%%%%%%%%%%%%%%%%%%%%%%%%%
    \widehat{clo} \in \widehat{\textit{Clo}}
    &\triangleq \textsf{Lam} \times \widehat{\textit{Env}} \\
    %%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT ADDRESSES %%%%%%%%%%%%%%%%%%%%%%%%%
    \hat{a},\hat{a}_{\hat{\kappa}} \in \textit{Addr} &\triangleq \mathbb{N} \\
    %%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT TIME %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \hat{t} \in \textit{Time} &\triangleq \mathbb{N} \\
    %%%%%%%%%%%%%%%%%%%%%%%%% OTHER ABSTRACT VARIABLES %%%%%%%%%%%%%%%%%%%%%%%%%
    \widehat{done} &\triangleq \widehat{\textit{Val}}^* \\
  \end{align*}
  \begin{center}
    \textbf{Abstract Atomic Evaluation:} \\
    $\mathcal{A} : \textit{Eval} \rightarrow \widehat{\textit{Val}}$
  \end{center}
  \vspace{-7mm}
  \begin{align*}
    \mathcal{A}(E\langle lam , \hat{\rho} , ... \rangle)
    &\triangleq \{ (lam , \hat{\rho}) \} \\
    \mathcal{A}(\mae)
    &\triangleq \{\mae\} \\
  \end{align*}
  %%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% COLUMN BREAK %%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%
  \vfill\null
  \columnbreak
  %%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% COLUMN BREAK %%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{align*}
    %%%%%%%%%%%%%%%%%%%%%%%%% ABSTRACT KONTINUATIONS %%%%%%%%%%%%%%%%%%%%%%%%%
    \hat{\kappa} \in \widehat{\textit{Kont}} &::= \textbf{mt} \\
    &|\; \textbf{ifk}(e, e, \hat{\rho}, \hat{a}_{\hat{\kappa}}) \\
    &|\; \textbf{callcck}(\hat{a}_{\hat\kappa}) \\
    &|\; \textbf{setk}(\hat{a}, \hat{a}_{\hat{\kappa}}) \\
    &|\; \textbf{appappk}(\widehat{val}?, e, \hat{\rho}, \hat{a}_{\hat\kappa}) \\
    &|\; \textbf{appk}(\widehat{done}, todo, \hat{\rho}, \hat{a}_{\hat\kappa}) \\
    &|\; \textbf{appprimk}(op, \hat{a}_{\hat\kappa}) \\
    &|\; \textbf{primk}(op, \widehat{done}, todo, \\
    &\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\hat{\rho}, \hat{a}_{\hat\kappa}) \\
    &|\; \textbf{letk}(vars, \widehat{done}, todo, \\
    &\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;e, \hat{\rho}, \hat{a}_{\hat\kappa}) \\
  \end{align*}
  \begin{center}
    \textbf{Tick/Alloc:}
  \end{center}
  \vspace{-7mm}
  \begin{align*}
    \widehat{tick}:\widehat{\Sigma}
    &\times \widehat{\textit{Kont}} \rightarrow \widehat{\textit{Time}} \\
    \widehat{tick}(\hat{\varsigma}, \hat{\kappa}) &\triangleq 0 \\
    \widehat{alloc}:\hat{\Sigma}
    &\times \widehat{\textit{Kont}} \rightarrow \widehat{\textit{Addr}} \\
    \widehat{alloc}(\hat{\varsigma}, \hat{\kappa}) &\triangleq 0 \\
  \end{align*}
\end{multicols*}



\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%% BEGIN ABSTRACT EVAL SEMANTICS %%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\footnotesize{
\begin{multicols*}{2}
[
\begin{center}
\textbf{Abstract Eval Rules} \\
Rules for when the control is an expression \\
%%%%%%%%%%%%%%%%%%%%%%%%% ATOMIC EVALUATION %%%%%%%%%%%%%%%%
\vspace{10mm}
  $E\langle \mae , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle
  \leadsto
  A\langle \hat{v} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$ \\
where $\hat{v} \triangleq \hat{\mathcal{A}}(\hat{\varsigma}, \hat{\sigma})$ \\
\end{center}
]
%%%%%%%%%%%%%%%%%%%%%%%%% IF EXPRESSION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \ifsyn{e_c}{e_t}{e_f} , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e_c , \hat{\rho} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-3mm}
\begin{align*}
  \text{where } \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa} &\triangleq \textbf{ifk}(e_t, e_f, \hat{\rho}, \hat{a}_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% LET EXPRESSION NO ARGSVALS %%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle (\texttt{let}\;()\;e) , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%% LET EXPRESSION VALS GOT ARGS %%%%%%%%%%%%%%%
\begin{center}
  $E\langle
  (\texttt{let}\;bnds\;e_b), \hat{\rho}  , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e_0 , \hat{\rho}  , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-4mm}
\begin{align*}
  \text{where }
  bnds &= ([x_0\;e_0]\;[x_s\;e_s]\;...) \\
  \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa} &\triangleq \textbf{letk}(x_0::x_s, [\;], e_s, e_b, \hat{\rho}, \hat{a}_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% CALL/CC EXPRESSION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \callccsyn{e} , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e , \hat{\rho} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-4mm}
\begin{align*}
  \text{where } \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa} &\triangleq \textbf{callcck}(\hat{\rho}, \hat{a}_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% SET EXPRESSION %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \setsyn{x}{e} , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e , \hat{\rho} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}}' , \hat{t}'\rangle$
\end{center}
\vspace{-4mm}
\begin{align*}
  \text{where } \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{a} &\triangleq \hat{\rho}(x) \\
  \hat{\kappa} &\triangleq \textbf{setk}(\hat{a}, \hat{a}_{\hat\kappa}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}]
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\vfill\null
\columnbreak
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%% PRIM NO ARG EXPRESSION %%%%%%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \singleprimsyn{op} , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto A\langle \hat{v} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } \hat{v} &= op \text{ applied to } 0 \text{ arguments}
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% PRIM WITH ARGS EXPRESSION %%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \primsyn{op}{e_0\;e_s} , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e_0 , \hat{\rho} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}}' , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa} &\triangleq \textbf{primk}(op, [\;], e_s, \hat{\rho}, \hat{a}_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY PRIM EXPRESSION %%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \applyprimsyn{op}{e} , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e , \hat{\rho} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}}' , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa} &\triangleq \textbf{appprimk}(op, \hat{a}_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY FUNCTION LIST EXPRESSION %%%%%%%%%%%%%%%%
\begin{center}
  $E\langle \applysyn{e_f}{e_x} , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e_f , \hat{\rho} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}}' , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa} &\triangleq \textbf{appappk}(\varnothing , e_x , \hat{\rho}, \hat{a}_{\hat{\kappa}}) \\
\hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION EXPRESSION %%%%%%%%%%%%%%%%
\begin{center}
  $E\langle (e_f\;e_s\;...) , \hat{\rho} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t}\,\rangle$
  $\leadsto E\langle e_f , \hat{\rho} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}}' , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa} &\triangleq \textbf{appk}([\;],  e_s , \hat{\rho}, \hat{a}_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}]
\end{align*}
\end{multicols*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%% ABSTRACT APPLY SEMANTICS %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%% Page 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\begin{multicols*}{2}
[
\begin{center}
\textbf{Apply Rules} \\
Rules for when the control is a value \\
$\hat{\varsigma} = A\langle \hat{v} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}_{\hat{\kappa}} , \hat{t} \rangle$ \\
$\hat{\kappa} \in \hat{\sigma}_{\hat{\kappa}}(\hat{a}_{\hat{\kappa}})$ \\
Proceed by matching on $\hat{\kappa}$ \\
%%%%%%%%%%%%%%%%%%%%%%%%% EMPTY KONT %%%%%%%%%%%%%%%%%%%%%%%%%
\vspace{5mm}
$\textbf{mt} \leadsto \hat{\varsigma}$
\end{center}
\vspace{-5mm}
]
%%%%%%%%%%%%%%%%%%%%%%%%% IF KONT FALSE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{ifk}(e_t, e_f, \hat{\rho}_{\hat{\kappa}}, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_f , \hat{\rho}_{\hat{\kappa}} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}\,\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } \hat{v} &= \falsesyn
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% IF KONT TRUE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{ifk}(e_t, e_f, \hat{\rho}_{\hat{\kappa}}, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_t , \hat{\rho}_{\hat{\kappa}}, \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t} \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } \hat{v} &\not= \falsesyn
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% LET KONT DONE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{letk}(vars, \widehat{done}, [\;], e_b, \hat{\rho}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_b , \hat{\rho}'_{\hat{\kappa}} , \hat{\sigma}' , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle $
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{a}_i &\triangleq \widehat{alloc}(\hat{\varsigma}, i, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, n, \hat{\kappa}) \\
  \hat{\rho}'_{\hat{\kappa}} &\triangleq \hat{\rho}_{\hat{\kappa}}[vars_0 \mapsto \hat{a}_0\;...\\
  &\;\;\;\;\;\;\;\;\;\,  vars_{n-1} \mapsto \hat{a}_{n-1}] \\
  \widehat{done}' &\triangleq \widehat{done} \mdoubleplus [\hat{v}] \\
  \hat{\sigma}' &\triangleq \hat{\sigma} \sqcup [\hat{a}_0 \mapsto \widehat{done}'_0\;...\\
  &\;\;\;\;\;\;\;\;\;\;\;\; \hat{a}_{n-1} \mapsto \widehat{done}'_{n-1}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% LET KONT MORE TODO %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{letk}(vars, \widehat{done}, e_h::e_t , e_b , \hat{\rho}_{\hat{\kappa}}, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_h , \hat{\rho}_{\hat{\kappa}} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}''_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{a}''_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa}' &\triangleq \textbf{letk}(vars, \widehat{done}, \mdoubleplus [\hat{v}],\\
  &\;\;\;\;\;\;\;\;\;\;\;\;\;\, e_t , e_b , \hat{\rho}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}''_{\hat{\kappa}} \mapsto \hat{\kappa}']
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% SET! KONT %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{setk}(x, \hat{\rho}_{\hat{\kappa}}, \hat{a}'_{\hat{\kappa}})$
  $\leadsto A\langle \textit{Void} , \hat{\sigma}' , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}\,\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{\sigma}' &\triangleq \hat{\sigma} \sqcup [\hat{\rho}_{\hat{\kappa}}(x) \mapsto \hat{v}]
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\vfill\null
\columnbreak
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%% CALL/CC MULTIARG KONT %%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{callcck}(\hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e , \hat{\rho}'_{\lambda} , \hat{\sigma}' , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}\,\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  \hat{v} &= (\singlelamsyn{x}{e} , \hat{\rho}_{\lambda}) \\
  \hat{a} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa}' &\triangleq \hat{\sigma}_{\hat{\kappa}}(\hat{a}'_{\hat{\kappa}}) \\
  \hat{\rho}'_{\lambda} &\triangleq \hat{\rho}_{\lambda}[x \mapsto \hat{a}] \\
  \hat{\sigma}' &\triangleq \hat{\sigma} \sqcup [\hat{a} \mapsto \hat{\kappa}']
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% CALL/CC KONT ARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{callcck}(\_)$
  $\leadsto A\langle \hat{\kappa} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat\kappa}  , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } v &= \kappa' \\
  \hat{a}'_{\hat\kappa} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \kappa']
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY PRIM KONT %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appprimk}(op, \hat{a}'_{\hat{\kappa}})$
  $\leadsto A\langle \hat{v}' , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}\,\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } \hat{v}' &\triangleq op \text{ applied to } \hat{v}
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% PRIM KONT DONE %%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{primk}(op, \widehat{done}, [\;], \_, \hat{a}'_{\hat{\kappa}})$
  $\leadsto A\langle \hat{v}' , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}\,\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } \hat{v}' &\triangleq op \text{ applied to } (\widehat{done} \mdoubleplus [\hat{v}])
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% PRIM KONT NOT DONE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{primk}(op, \widehat{done}, e_h::e_t, \hat{\rho}_{\hat{\kappa}}, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_h , \hat{\rho}_{\hat{\kappa}} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}''_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{a}''_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa}' &\triangleq \textbf{primk}(op, \widehat{done} \mdoubleplus [\hat{v}]) \\
  &\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; e_t, \hat{\rho}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}''_{\hat{\kappa}} \mapsto \hat{\kappa}']
\end{align*}
\end{multicols*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%% ABSTRACT APPLY SEMANTICS %%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% PAGE 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\begin{multicols*}{2}
[
\begin{center}
\textbf{More Apply Rules} \\
Rules for when the control is a value
\end{center}
]
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY LIST DONE MULTIARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appappk}(\hat{v}_f, \_, \_, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_b , \hat{\rho}'_{\lambda} , \hat{\sigma}' ,
  \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{v}_f &= (\lamsyn{x_s}{e_b}, \hat{\rho}_{\lambda}) \\
  \hat{a}_i &\triangleq \widehat{alloc}(\hat{\varsigma}, i, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, n, \hat{\kappa}) \\
  \hat{\rho}'_{\lambda} &\triangleq \hat{\rho}_{\lambda}[x_0 \mapsto \hat{a}_0\; ... \\
                          &\;\;\;\;\;\;\;\;\;\;x_{n-1} \mapsto \hat{a}_{n-1}] \\
  \hat{\sigma}' &\triangleq \hat{\sigma} \sqcup [\hat{a}_0 \mapsto \hat{v}_0\;... \\
  &\;\;\;\;\;\;\;\;\;\;\;\;\hat{a}_{n-1} \mapsto \hat{v}_{n-1}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY LIST DONE VARARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appappk}(\hat{v}_f, \_, \_, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_b , \hat{\rho}'_\lambda , \hat{\sigma}' , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \hat{v}_f &= (\vararglamsyn{x}{e_b}, \hat{\rho}_{\lambda}) \\
  \hat{a} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\rho}'_{\lambda} &\triangleq \hat{\rho}_{\lambda}[x \mapsto \hat{a}] \\
  \hat{\sigma}' &\triangleq \hat{\sigma} \sqcup [\hat{a}'_{\hat{\kappa}} \mapsto \hat{v}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLY LIST KONT TODO %%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appappk}(\varnothing, e, \hat{\rho}_{\hat{\kappa}}, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e , \hat{\rho}_{\hat{\kappa}} , \hat{\sigma} , \hat{\sigma}_{\hat{\kappa}} , \hat{a}''_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  \hat{a}''_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa}' &\triangleq \textbf{appappk}(\hat{v}, e, \hat{\rho}_{\hat{\kappa}}, \hat{a}'_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup [\hat{a}''_{\hat{\kappa}} \mapsto \hat{\kappa}']
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\vfill\null
\columnbreak
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% COLUMN BREAK %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION MULTIARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appk}(\widehat{done}, [\;], \_, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_b , \hat{\rho}'_\lambda , \hat{\sigma}' , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where } \widehat{done} &= (\lamsyn{x_s}{e_b}, \hat{\rho}_{\lambda}) :: \hat{v}_s \\
  \hat{a}_i &\triangleq \widehat{alloc}(\hat{\varsigma}, i, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, n, \hat{\kappa}) \\
  \hat{\rho}'_{\lambda} &\triangleq \hat{\rho}_{\lambda}[x_0 \mapsto \hat{a}_0 \;... \\
  &\;\;\;\;\;\;\;\;\;\;x_{n-1} \mapsto \hat{a}_{n-1}] \\
  \hat{v}'_s &\triangleq \hat{v}_s \mdoubleplus [\hat{v}] \\
  \hat{\sigma}' &\triangleq \hat{\sigma} \sqcup
                  [\hat{a}_0 \mapsto \hat{v}'_0\;...\\
  &\;\;\;\;\;\;\;\;\;\;\;\;\hat{a}_{n-1} \mapsto \hat{v}'_{n-1}]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION VARARG %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appk}(\widehat{done}, [\;], \_, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_b, \hat{\rho}'_\lambda , \hat{\sigma}' , \hat{\sigma}_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
\text{where } \widehat{done} &= (\vararglamsyn{x}{e_b}, \hat{\rho}_{\lambda}) :: \hat{v}_s \\
  \hat{a} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\rho}'_{\lambda} &\triangleq \hat{\rho}_{\lambda}[x \mapsto \hat{a}] \\
  \hat{v}'_s &\triangleq \hat{v}_s \mdoubleplus [\hat{v}] \\
  \hat{\sigma}' &\triangleq \hat{\sigma} \sqcup
                  [\hat{a} \mapsto \hat{v}'_s]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION KONTINUATION %%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appk}([\hat{\kappa}_\lambda] , [\;] , \hat{\rho}_{\hat{\kappa}} , \_)$
  $\leadsto A\langle \hat{v} , \hat{\sigma} , \hat{\sigma}'_{\hat{\kappa}} , \hat{a}'_{\hat{\kappa}} , \hat{t}'\rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  \hat{a}'_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma} \sqcup
                                 [\hat{a}'_{\hat{\kappa}} \mapsto \hat{\kappa}_\lambda]
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% APPLICATION NOT DONE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
  $\textbf{appk}(\widehat{done}, e_h::e_t, \hat{\rho}_{\hat{\kappa}}, \hat{a}'_{\hat{\kappa}})$
  $\leadsto E\langle e_h , \hat{\rho}_{\hat{\kappa}} , \hat{\sigma} ,
  \hat{\sigma}'_{\hat{\kappa}} , \hat{a}''_{\hat{\kappa}} , \hat{t}' \rangle$
\end{center}
\vspace{-7mm}
\begin{align*}
  \text{where }
  \hat{a}''_{\hat{\kappa}} &\triangleq \widehat{alloc}(\hat{\varsigma}, 0, \hat{\kappa}) \\
  \hat{t}' &\triangleq \widehat{tick}(\hat{\varsigma}, 1, \hat{\kappa}) \\
  \hat{\kappa}' &\triangleq \textbf{appk}(\widehat{done} \mdoubleplus [\hat{v}],
                  e_t, \hat{\rho}_{\kappa}, \hat{a}'_{\hat{\kappa}}) \\
  \hat{\sigma}'_{\hat{\kappa}} &\triangleq \hat{\sigma}_{\hat{\kappa}} \sqcup
                                 [\hat{a}''_{\hat{\kappa}} \mapsto \hat{\kappa}']
\end{align*}
%%%%%%%%%%%%%%%%%%%%%%%%% ITS OVER %%%%%%%%%%%%%%%%%%%%%%%%%
\end{multicols*}


\end{document}
