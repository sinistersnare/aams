\title{CESK* / CFA Formalism}
\author{
	Davis Silverman
}
\date{}

\documentclass[12pt,draft]{article}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{tikz}
\usepackage{titling}
%\usepackage{bm}

\setlength{\droptitle}{-10em}  % Make title not in middle of page (uses titling package)
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}
\newcommand\mdoubleplus{\ensuremath{\mathbin{+\mkern-9mu+}}}
\newcommand\mae{\ensuremath{\text{\ae}}}
% \setcounter{section}{-1} % sets the first section number to 0
\begin{document}

\newcommand{\lamsyn}[2]{(\lambda\;(#1 ...)\;#2)}
\newcommand{\letsyn}[3]{(\texttt{let}\;(#1\;#2)\;#3)}
\newcommand{\ifsyn}[3]{(\texttt{if}\;#1\;#2\;#3)}
\newcommand{\primsyn}[3]{(\texttt{prim}\;#1\;#2\;#3 ...)}
\newcommand{\truesyn}{\texttt{\#t}}
\newcommand{\falsesyn}{\texttt{\#f}}

% textsf for syntactic domains
% textit for semantic domains

\section{Semantics of Basic Scheme CESK*}


\begin{center}
\textbf{Syntax:}
\end{center}
\vspace{-7mm}
\begin{align*}
%%% Expressions
e \in \textsf{Exp} &::= \mae \\
				  &	\;\;\;\;\; \;|\; \ifsyn{e}{e}{e}  \\
				  &	\;\;\;\;\; \;|\; \letsyn{x}{e}{e} \\
				  &	\;\;\;\;\; \;|\; \primsyn{op}{e}{e} \\
				  &	\;\;\;\;\; \;|\; (e \; e \; ...) \\
%%% Atomic Expressions
\mae \in \textsf{AExp} &::= lam \;|\; \mathbb{Z} \;|\; \truesyn \;|\; \falsesyn \\
%%% Lambdas
lam \in \textsf{Lam} &::= \lamsyn{x}{e} \\
%%% Variables
x \in \textsf{Var} &\;\;\;\;\;\; \text{A set of identifiers}
\end{align*}
\vspace{-10mm}
\begin{center}
\textbf{Semantics:}
\end{center}
\vspace{-7mm}
\begin{align*}
%%% State
\varsigma \in \Sigma &\triangleq \textsf{Exp} \times \textit{Env} \times \textit{Kont} \\
%%% Environment
\rho \in \textit{Env} &\triangleq \textsf{Var} \rightharpoonup \textit{Addr} \\
%%% Store
\sigma \in \textit{Store} &\triangleq \textit{Addr} \rightharpoonup \textit{Val} \\
%%% Values
v \in \textit{Val} &\triangleq \textit{Clo} + \mathbb{Z} + \{\truesyn, \falsesyn\} \\
%%% Closures
clo \in \textit{Clo} &\triangleq \textsf{Lam} \times \textit{Env} \\
%%% Kontinuations
\kappa \in \textit{Kont} &\triangleq \textbf{mt} \;|\; \textbf{appk}(done, todo, \rho, a) \\
					   &	\;\;\;\;\;\;\;\;\;\; \;|\; \textbf{ifk}(e, e, \rho, a) \\
					   &	\;\;\;\;\;\;\;\;\;\; \;|\; \textbf{letk}(x, e, \rho, a) \\
%%% Addresses
a,b,c \in \textit{Addr} &\;\;\;\;\; \text{A set of addreses} \\
%%% done/todo variables
done \triangleq \textit{Val}* \;\;&\;\; todo \triangleq \textsf{Exp}*
\end{align*}
\vspace{-10mm}
\begin{center}
\textbf{Atomic Evaluation Function:}
\end{center}
\vspace{-7mm}
\begin{align*}
\mathcal{A}(x, \rho, \sigma) &\triangleq \sigma(\rho(x)) \\
\mathcal{A}(lam, \rho, \sigma) &\triangleq (lam , \rho) \\
\mathcal{A}(\mae, \rho, \sigma) &\triangleq \mae
\end{align*}
\vspace{-10mm}
\begin{center}
\textbf{Transition Function:}
\end{center}
\vspace{-7mm}
\begin{align*}
(\Sigma \times \textit{Store}) \leadsto (\Sigma \times \textit{Store})
\end{align*}

\newpage



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%
%%% Begin Semantics
%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{center}
\begin{tabular}{@{}l | r@{}}
\multicolumn{2}{c}{$(\varsigma \times \sigma) \rightarrow (\varsigma' \times \sigma)$, 
where $\kappa = \sigma(a) , b = alloc(\varsigma) $} \\
\multicolumn{2}{c}{proceed by matching on $\varsigma$} \\
\hline\hline
%%%%% IF EXP
$\langle
\ifsyn{e_c}{e_t}{e_f} , \rho , a
\rangle$
&$\langle
e_c , \rho , b 
\rangle$ \\
& $\sigma[b \mapsto \textbf{ifk}(e_t , e_f , \rho , a)]$ \\
\hline
%%%%% LET EXP
$\langle
\letsyn{x}{e_x}{e_b} , \rho , a
\rangle$
&$\langle
e_x , \rho , b
\rangle$ \\
& $\sigma[b \mapsto \textbf{letk}(x , e_b , \rho , a)]$ \\
\hline
%%%%% PRIM EXP
$\langle
\primsyn{op}{e_0}{es} , \rho , a
\rangle$
&$\langle
e_0 , \rho , b
\rangle$ \\
& $\sigma[b \mapsto \textbf{appk}([op] ,  es , \rho , a)]$ \\
\hline
%%%%% APPLICATION EXP
$\langle
(e_f \; es ...) , \rho , a
\rangle$
&$\langle
e_f , \rho , b
\rangle$ \\
& $\sigma[b \mapsto \textbf{appk}([] , e_s , \rho , a)]$ \\
\hline
%%%%% ATOMIC EXP -- TIME TO MATCH ON K
$\langle \mae , \rho , a \rangle$ & \\
let $v = \mathcal{A}(\mae, \rho, \sigma)$ \\
match on $\kappa$ below \\
\hline
%%%%% MT KONTINUATION
$ \textbf{mt}$ & $\varsigma$ \\
\hline
%%%%% IF KONTINUATION FALSE
$ \textbf{ifk}(e_t , e_f , \rho' , c) $ 
& $\langle e_f , \rho' , c \rangle$ \\
when $v = \falsesyn$ & \\
\hline
%%%%% IF KONTINUATION TRUE
$ \textbf{ifk}(e_t , e_f , \rho' , c) $ 
& $\langle e_t , \rho' , c \rangle$ \\
when $v \not= \falsesyn$ & \\
\hline
%%%%% LET KONTINUATION
$ \textbf{letk}(x , e_b , \rho' , c) $
& $\langle e_b , \rho'[x \mapsto b] , c \rangle$ \\
& $ \sigma[b \mapsto v] $ \\
\hline
%%%%% APP KONTINUATION MORE
$ \textbf{appk}(done, e_h::e_t , \rho' , c) $
& $\langle e_h , \rho' , b \rangle$ \\
& $ \sigma[b \mapsto \textbf{appk}(done \mdoubleplus [v] , e_t , \rho' , c)] $ \\
\hline
%%%%% APP KONTINUATION DONE PRIM
$ \textbf{appk}(op :: v_s , [] , \rho' , c) $
& $\langle v' , \rho' , c \rangle$ \\
& $ v' = op $ applied to $(v_s \mdoubleplus [v])$ \\
\hline
%%%%% APP KONTINUATION DONE CLO
$ \textbf{appk}(clo :: v_s, [\;] , \rho' , c) $
& $\langle e_b , \rho_{\lambda}[xs_0 \mapsto b_0 ... xs_i \mapsto b_i] , c \rangle$ \\
where $ clo = (\lamsyn{xs}{e_b} , \rho_{\lambda}) $ & $ v'_s = v_s \mdoubleplus [v] $ \\
& $ \sigma[b_0 \mapsto v'_{s0} ... b_i \mapsto v'_{si}] $  \\
\hline
\end{tabular}
\end{center}

\newpage

\section{Formalization of an Abstract CESK* machine with basic Scheme features.}




























\end{document}
  